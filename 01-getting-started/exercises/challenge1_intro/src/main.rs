// ============================================================
// 도전 과제 1: 자기소개 프로그램
// ============================================================
// 이름, 나이, 직업을 입력받아 자기소개 문장을 출력한다.
// ============================================================

// ------------------------------------------------------------
// use 키워드: 외부 모듈을 현재 스코프로 가져온다
// ------------------------------------------------------------
// std::io는 Rust 표준 라이브러리(std)의 입출력(io) 모듈이다.
// 이 모듈에는 키보드 입력(stdin), 화면 출력 등의 기능이 있다.
// use를 사용하면 매번 std::io::stdin() 대신 io::stdin()으로 짧게 쓸 수 있다.
//
// ┌─────────────────────────────────────────────────────────────┐
// │  모듈 구조 시각화                                           │
// ├─────────────────────────────────────────────────────────────┤
// │                                                             │
// │   std (표준 라이브러리)                                     │
// │   ├── io          <- 우리가 사용하는 모듈                   │
// │   │   ├── stdin() <- 키보드 입력                            │
// │   │   ├── stdout() <- 화면 출력                             │
// │   │   └── ...                                               │
// │   ├── collections <- Vec, HashMap 등                        │
// │   ├── fs          <- 파일 시스템                            │
// │   └── ...                                                   │
// │                                                             │
// └─────────────────────────────────────────────────────────────┘
use std::io;

// ------------------------------------------------------------
// fn main(): 프로그램의 시작점 (entry point)
// ------------------------------------------------------------
// 모든 Rust 실행 파일은 반드시 main 함수가 있어야 한다.
// 프로그램 실행 시 운영체제가 이 함수를 가장 먼저 호출한다.
// fn은 "function"의 약자로, 함수를 정의하는 키워드이다.
//
// ┌─────────────────────────────────────────────────────────────┐
// │  프로그램 실행 흐름                                         │
// ├─────────────────────────────────────────────────────────────┤
// │                                                             │
// │   운영체제                                                  │
// │       │                                                     │
// │       ▼                                                     │
// │   main() 함수 호출                                          │
// │       │                                                     │
// │       ▼                                                     │
// │   코드 순차 실행                                            │
// │       │                                                     │
// │       ▼                                                     │
// │   main() 종료 = 프로그램 종료                               │
// │                                                             │
// └─────────────────────────────────────────────────────────────┘
fn main() {
    // --------------------------------------------------------
    // 변수 선언: let mut
    // --------------------------------------------------------
    // let: 변수를 선언하는 키워드
    // mut: "mutable"의 약자. 변수를 변경 가능하게 만든다.
    //      Rust에서 변수는 기본적으로 불변(immutable)이다.
    //      나중에 값을 바꿔야 하면 반드시 mut를 붙여야 한다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  불변(immutable) vs 가변(mutable)                       │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   let x = 5;        // 불변 - 값 변경 불가              │
    // │   x = 10;           // 컴파일 에러!                     │
    // │                                                         │
    // │   let mut y = 5;    // 가변 - 값 변경 가능              │
    // │   y = 10;           // OK!                              │
    // │                                                         │
    // │   왜 기본이 불변인가?                                   │
    // │   - 버그 방지: 의도치 않은 값 변경 막음                 │
    // │   - 코드 이해 쉬움: 변수가 안 바뀜을 보장               │
    // │   - 동시성 안전: 여러 스레드가 읽어도 안전              │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    //
    // String::new(): 빈 문자열을 생성한다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  String vs &str (문자열 타입)                           │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   String                    &str                        │
    // │   ┌─────────────────┐      ┌─────────────────┐         │
    // │   │ 소유권 있음     │      │ 소유권 없음 (빌림)│         │
    // │   │ 힙에 저장       │      │ 어딘가를 참조    │         │
    // │   │ 크기 변경 가능  │      │ 크기 고정       │         │
    // │   │ 수정 가능       │      │ 읽기 전용       │         │
    // │   └─────────────────┘      └─────────────────┘         │
    // │                                                         │
    // │   예시:                                                 │
    // │   let s1 = String::from("hello");  // String           │
    // │   let s2 = "hello";                // &str             │
    // │   let s3 = s1.trim();              // &str 반환        │
    // │                                                         │
    // │   07-collections에서 자세히 학습한다.                   │
    // └─────────────────────────────────────────────────────────┘
    //
    // ::new()는 "연관 함수(associated function)"로,
    // 다른 언어의 정적 메서드(static method)와 비슷하다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  연관 함수 vs 메서드                                    │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   연관 함수 (:: 사용)                                   │
    // │   - 타입 자체에서 호출                                  │
    // │   - 인스턴스 필요 없음                                  │
    // │   - 예: String::new(), String::from("hello")           │
    // │                                                         │
    // │   메서드 (. 사용)                                       │
    // │   - 인스턴스에서 호출                                   │
    // │   - 예: my_string.len(), my_string.trim()              │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    let mut name = String::new();
    let mut age = String::new();
    let mut job = String::new();

    // --------------------------------------------------------
    // println! 매크로: 화면에 텍스트 출력
    // --------------------------------------------------------
    // println!은 함수가 아니라 "매크로"이다.
    // 매크로는 이름 끝에 느낌표(!)가 붙는다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  함수 vs 매크로                                         │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │              함수                  매크로               │
    // │   호출      function()            macro!()              │
    // │   인자 수   고정                   가변 (몇 개든 OK)    │
    // │   시점      런타임 호출           컴파일 시 코드 확장   │
    // │                                                         │
    // │   println!이 매크로인 이유:                             │
    // │   - 인자 개수가 가변적 (1개, 2개, 10개... 다 가능)      │
    // │   - 포맷 문자열을 컴파일 시점에 검사                    │
    // │                                                         │
    // │   println!("값: {}", x);     // 인자 2개               │
    // │   println!("{} + {} = {}", a, b, c);  // 인자 4개      │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    println!("=== 자기소개 프로그램 ===");
    println!();  // 빈 줄 출력

    // --------------------------------------------------------
    // 사용자 입력 받기: io::stdin().read_line()
    // --------------------------------------------------------
    println!("이름을 입력하세요:");

    // io::stdin(): 표준 입력(키보드)에 대한 핸들을 반환한다.
    // .read_line(&mut name): 한 줄을 읽어서 name 변수에 저장한다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  &mut name 설명: 참조와 빌림                            │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   & : "참조(reference)"                                 │
    // │       값을 복사하지 않고 원본 위치를 가리킨다           │
    // │       C의 포인터와 비슷하지만 더 안전하다               │
    // │                                                         │
    // │   mut : "가변"                                          │
    // │       참조를 통해 원본을 수정할 수 있다                 │
    // │                                                         │
    // │   ┌─────────────┐          ┌─────────────┐             │
    // │   │ read_line() │ ───────► │ name 변수   │             │
    // │   │             │  &mut    │ "홍길동"    │             │
    // │   │ (데이터 씀) │          │             │             │
    // │   └─────────────┘          └─────────────┘             │
    // │                                                         │
    // │   read_line에게 "name을 수정할 수 있는 권한"을 빌려줌   │
    // │   이것이 Rust의 핵심 개념 "빌림(borrowing)"이다.        │
    // │   03-ownership에서 자세히 학습한다.                     │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    //
    // .expect("에러 메시지"): 에러 처리
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  Result 타입과 에러 처리                                │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   read_line()은 Result<usize, Error>를 반환한다.        │
    // │                                                         │
    // │   Result는 두 가지 상태를 가진 열거형:                  │
    // │   ┌─────────────┐     ┌─────────────┐                  │
    // │   │ Ok(값)      │     │ Err(에러)   │                  │
    // │   │ 성공 시     │     │ 실패 시     │                  │
    // │   └─────────────┘     └─────────────┘                  │
    // │                                                         │
    // │   .expect()는:                                          │
    // │   - Ok면: 내부 값을 꺼내서 반환                         │
    // │   - Err면: 메시지 출력 후 프로그램 종료 (패닉)          │
    // │                                                         │
    // │   더 정교한 처리는 08-error-handling에서 배운다.        │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    io::stdin()
        .read_line(&mut name)
        .expect("이름 입력 실패");

    println!("나이를 입력하세요:");
    io::stdin()
        .read_line(&mut age)
        .expect("나이 입력 실패");

    println!("직업을 입력하세요:");
    io::stdin()
        .read_line(&mut job)
        .expect("직업 입력 실패");

    // --------------------------------------------------------
    // 문자열 처리: .trim()
    // --------------------------------------------------------
    // read_line()은 엔터키(줄바꿈 문자 \n)도 함께 저장한다.
    // 예: 사용자가 "홍길동"을 입력하면 실제로는 "홍길동\n"이 저장됨
    // .trim()은 문자열 앞뒤의 공백과 줄바꿈을 제거한다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  trim() 동작 시각화                                     │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   입력값: "  홍길동  \n"                                │
    // │                                                         │
    // │   메모리: [' '][' ']['홍']['길']['동'][' '][' ']['\n']  │
    // │           ^^^                         ^^^^^^^^^^^       │
    // │           앞 공백                     뒤 공백+줄바꿈     │
    // │                                                         │
    // │   trim() 후: "홍길동"                                   │
    // │   메모리: ['홍']['길']['동']                            │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    //
    // 섀도잉(Shadowing):
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  섀도잉이란?                                            │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   같은 이름으로 새 변수를 선언하면 이전 변수를 "가린다" │
    // │                                                         │
    // │   let name = String::new();     // name: String         │
    // │   let name = name.trim();       // name: &str (새 변수) │
    // │                                                         │
    // │   이전 name은 더 이상 접근 불가 (가려짐)                │
    // │                                                         │
    // │   섀도잉의 장점:                                        │
    // │   1. 타입을 바꿀 수 있다 (String -> &str)               │
    // │   2. 의미 있는 변수명 재사용 (name_str 같은 이름 불필요)│
    // │   3. 불필요한 mut 줄일 수 있다                          │
    // │                                                         │
    // │   주의: 재할당(=)과 다르다!                             │
    // │   let mut x = 5;                                        │
    // │   x = 10;           // 재할당: 같은 변수, 값만 변경     │
    // │   let x = 10;       // 섀도잉: 새 변수가 이전 것을 가림 │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    let name = name.trim();
    let age = age.trim();
    let job = job.trim();

    // --------------------------------------------------------
    // 포맷 문자열 출력
    // --------------------------------------------------------
    // {}는 플레이스홀더(placeholder)로, 뒤에 오는 인자로 대체된다.
    // 여러 개의 {}를 사용하면 순서대로 인자가 들어간다.
    //
    // ┌─────────────────────────────────────────────────────────┐
    // │  println! 포맷 문자열                                   │
    // ├─────────────────────────────────────────────────────────┤
    // │                                                         │
    // │   기본:     println!("{}", value);                      │
    // │                                                         │
    // │   여러 값:  println!("{} {} {}", a, b, c);              │
    // │             결과: "값1 값2 값3"                         │
    // │                                                         │
    // │   위치 지정: println!("{0} {1} {0}", a, b);             │
    // │             결과: "a값 b값 a값"                         │
    // │                                                         │
    // │   이름 지정: println!("{name} is {age}", name="Bob", age=25); │
    // │             결과: "Bob is 25"                           │
    // │                                                         │
    // │   정렬:     {:>10}  오른쪽 정렬, 10칸                   │
    // │            {:<10}  왼쪽 정렬, 10칸                      │
    // │            {:^10}  가운데 정렬, 10칸                    │
    // │                                                         │
    // │   디버그:   {:?}   Debug 형식 출력                      │
    // │            {:#?}  예쁜 Debug 형식 출력                  │
    // │                                                         │
    // └─────────────────────────────────────────────────────────┘
    println!();
    println!("========== 자기소개 ==========");
    println!("안녕하세요! 저는 {}살 {} {}입니다.", age, job, name);
    println!("==============================");
}
